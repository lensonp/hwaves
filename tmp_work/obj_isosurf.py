import os

import numpy as np
from hwaves import hwf,hwf_plot

output_dir = os.path.join(os.path.dirname(os.path.abspath(__file__)),'hwaves_obj')

def write_isosurface(n,l,absm,plusminus,ngrid,spc,obj_filename):
    r_iso = hwf.enclosed_density_radius(n,l,0.95)
    Rnl,Rnlsqr,isolev = hwf.radial_probability(n,l,r_iso)
    PV_isolev = isolev*spc**3
    print('95% enclosed charge radius: {}, density: {}'.format(r_iso,PV_isolev))
    #hwf_plot.plot_radial_wf(n,l,np.linspace(0,10,1000),showplot=True)
    hwf_plot.plot_real_wf_isosurface(n,l,absm,plusminus,ngrid,ngrid,ngrid,spc,spc,spc,isolevel=PV_isolev,showplot=True)
    hwf_plot.write_real_wf_isosurface(os.path.join(output_dir,obj_filename),n,l,absm,plusminus,ngrid,ngrid,ngrid,spc,spc,spc,isolevel=PV_isolev)

#n_to_run = [1,2,3,4,5,6,7]
n_to_run = [1,2]

if 1 in n_to_run:
    write_isosurface(1,0,0,None,100,0.05,'1_0_0.obj')

if 2 in n_to_run:
	write_isosurface(2,0,0,None,100,0.05,'2_0_0.obj')
	write_isosurface(2,1,0,None,100,0.1,'2_1_0.obj')
	write_isosurface(2,1,1,'+',100,0.1,'2_1_1_pos.obj')
	write_isosurface(2,1,1,'-',100,0.1,'2_1_1_neg.obj')

if 3 in n_to_run:
	write_isosurface(3,0,0,None,100,0.04,'3_0_0.obj')
	write_isosurface(3,1,0,None,100,0.1,'3_1_0.obj')
	write_isosurface(3,1,1,'+',100,0.1,'3_1_1_pos.obj')
	write_isosurface(3,1,1,'-',100,0.1,'3_1_1_neg.obj')
	write_isosurface(3,2,0,None,100,0.18,'3_2_0.obj')
	write_isosurface(3,2,1,'+',100,0.18,'3_2_1_pos.obj')
	write_isosurface(3,2,1,'-',100,0.18,'3_2_1_neg.obj')
	write_isosurface(3,2,2,'+',100,0.18,'3_2_2_pos.obj')
	write_isosurface(3,2,2,'-',100,0.18,'3_2_2_neg.obj')

if 4 in n_to_run:
	write_isosurface(4,0,0,None,100,0.04,'4_0_0.obj')
	write_isosurface(4,1,0,None,100,0.12,'4_1_0.obj')
	write_isosurface(4,1,1,'+',100,0.18,'4_1_1_pos.obj')
	write_isosurface(4,1,1,'-',100,0.18,'4_1_1_neg.obj')
	write_isosurface(4,2,0,None,100,0.18,'4_2_0.obj')
	write_isosurface(4,2,1,'+',100,0.24,'4_2_1_pos.obj')
	write_isosurface(4,2,1,'-',100,0.24,'4_2_1_neg.obj')
	write_isosurface(4,2,2,'+',100,0.24,'4_2_2_pos.obj')
	write_isosurface(4,2,2,'-',100,0.24,'4_2_2_neg.obj')
	write_isosurface(4,3,0,None,100,0.24,'4_3_0.obj')
	write_isosurface(4,3,1,'+',100,0.30,'4_3_1_pos.obj')
	write_isosurface(4,3,1,'-',100,0.30,'4_3_1_neg.obj')
	write_isosurface(4,3,2,'+',100,0.30,'4_3_2_pos.obj')
	write_isosurface(4,3,2,'-',100,0.30,'4_3_2_neg.obj')
	write_isosurface(4,3,3,'+',100,0.30,'4_3_3_pos.obj')
	write_isosurface(4,3,3,'-',100,0.30,'4_3_3_neg.obj')

if 5 in n_to_run:
	write_isosurface(5,0,0,None,100,0.04,'5_0_0.obj')
	write_isosurface(5,1,0,None,100,0.14,'5_1_0.obj')
	write_isosurface(5,1,1,'+',100,0.20,'5_1_1_pos.obj')
	write_isosurface(5,1,1,'-',100,0.20,'5_1_1_neg.obj')
	write_isosurface(5,2,0,None,100,0.20,'5_2_0.obj')
	write_isosurface(5,2,1,'+',100,0.28,'5_2_1_pos.obj')
	write_isosurface(5,2,1,'-',100,0.28,'5_2_1_neg.obj')
	write_isosurface(5,2,2,'+',100,0.28,'5_2_2_pos.obj')
	write_isosurface(5,2,2,'-',100,0.28,'5_2_2_neg.obj')
	write_isosurface(5,3,0,None,100,0.28,'5_3_0.obj')
	write_isosurface(5,3,1,'+',100,0.40,'5_3_1_pos.obj')
	write_isosurface(5,3,1,'-',100,0.40,'5_3_1_neg.obj')
	write_isosurface(5,3,2,'+',100,0.40,'5_3_2_pos.obj')
	write_isosurface(5,3,2,'-',100,0.40,'5_3_2_neg.obj')
	write_isosurface(5,3,3,'+',100,0.40,'5_3_3_pos.obj')
	write_isosurface(5,3,3,'-',100,0.40,'5_3_3_neg.obj')
	write_isosurface(5,4,0,None,100,0.40,'5_4_0.obj')
	write_isosurface(5,4,1,'+',100,0.50,'5_4_1_pos.obj')
	write_isosurface(5,4,1,'-',100,0.50,'5_4_1_neg.obj')
	write_isosurface(5,4,2,'+',100,0.50,'5_4_2_pos.obj')
	write_isosurface(5,4,2,'-',100,0.50,'5_4_2_neg.obj')
	write_isosurface(5,4,3,'+',100,0.50,'5_4_3_pos.obj')
	write_isosurface(5,4,3,'-',100,0.50,'5_4_3_neg.obj')
	write_isosurface(5,4,4,'+',100,0.50,'5_4_4_pos.obj')
	write_isosurface(5,4,4,'-',100,0.50,'5_4_4_neg.obj')

if 6 in n_to_run:
	write_isosurface(6,0,0,None,100,0.04,'6_0_0.obj')
	write_isosurface(6,1,0,None,100,0.14,'6_1_0.obj')
	write_isosurface(6,1,1,'+',100,0.20,'6_1_1_pos.obj')
	write_isosurface(6,1,1,'-',100,0.20,'6_1_1_neg.obj')
	write_isosurface(6,2,0,None,100,0.20,'6_2_0.obj')
	write_isosurface(6,2,1,'+',100,0.28,'6_2_1_pos.obj')
	write_isosurface(6,2,1,'-',100,0.28,'6_2_1_neg.obj')
	write_isosurface(6,2,2,'+',100,0.28,'6_2_2_pos.obj')
	write_isosurface(6,2,2,'-',100,0.28,'6_2_2_neg.obj')
	write_isosurface(6,3,0,None,100,0.28,'6_3_0.obj')
	write_isosurface(6,3,1,'+',100,0.40,'6_3_1_pos.obj')
	write_isosurface(6,3,1,'-',100,0.40,'6_3_1_neg.obj')
	write_isosurface(6,3,2,'+',100,0.40,'6_3_2_pos.obj')
	write_isosurface(6,3,2,'-',100,0.40,'6_3_2_neg.obj')
	write_isosurface(6,3,3,'+',100,0.40,'6_3_3_pos.obj')
	write_isosurface(6,3,3,'-',100,0.40,'6_3_3_neg.obj')
	write_isosurface(6,4,0,None,100,0.40,'6_4_0.obj')
	write_isosurface(6,4,1,'+',100,0.50,'6_4_1_pos.obj')
	write_isosurface(6,4,1,'-',100,0.50,'6_4_1_neg.obj')
	write_isosurface(6,4,2,'+',100,0.50,'6_4_2_pos.obj')
	write_isosurface(6,4,2,'-',100,0.50,'6_4_2_neg.obj')
	write_isosurface(6,4,3,'+',100,0.50,'6_4_3_pos.obj')
	write_isosurface(6,4,3,'-',100,0.50,'6_4_3_neg.obj')
	write_isosurface(6,4,4,'+',100,0.50,'6_4_4_pos.obj')
	write_isosurface(6,4,4,'-',100,0.50,'6_4_4_neg.obj')
	write_isosurface(6,5,0,None,100,0.60,'6_5_0.obj')
	write_isosurface(6,5,1,'+',100,0.60,'6_5_1_pos.obj')
	write_isosurface(6,5,1,'-',100,0.60,'6_5_1_neg.obj')
	write_isosurface(6,5,2,'+',100,0.60,'6_5_2_pos.obj')
	write_isosurface(6,5,2,'-',100,0.60,'6_5_2_neg.obj')
	write_isosurface(6,5,3,'+',100,0.60,'6_5_3_pos.obj')
	write_isosurface(6,5,3,'-',100,0.60,'6_5_3_neg.obj')
	write_isosurface(6,5,4,'+',100,0.60,'6_5_4_pos.obj')
	write_isosurface(6,5,4,'-',100,0.60,'6_5_4_neg.obj')
	write_isosurface(6,5,5,'+',100,0.60,'6_5_5_pos.obj')
	write_isosurface(6,5,5,'-',100,0.60,'6_5_5_neg.obj')

if 7 in n_to_run:
	write_isosurface(7,0,0,None,100,0.04,'7_0_0.obj')
	write_isosurface(7,1,0,None,100,0.14,'7_1_0.obj')
	write_isosurface(7,1,1,'+',100,0.20,'7_1_1_pos.obj')
	write_isosurface(7,1,1,'-',100,0.20,'7_1_1_neg.obj')
	write_isosurface(7,2,0,None,100,0.20,'7_2_0.obj')
	write_isosurface(7,2,1,'+',100,0.28,'7_2_1_pos.obj')
	write_isosurface(7,2,1,'-',100,0.28,'7_2_1_neg.obj')
	write_isosurface(7,2,2,'+',100,0.28,'7_2_2_pos.obj')
	write_isosurface(7,2,2,'-',100,0.28,'7_2_2_neg.obj')
	write_isosurface(7,3,0,None,100,0.28,'7_3_0.obj')
	write_isosurface(7,3,1,'+',100,0.40,'7_3_1_pos.obj')
	write_isosurface(7,3,1,'-',100,0.40,'7_3_1_neg.obj')
	write_isosurface(7,3,2,'+',100,0.40,'7_3_2_pos.obj')
	write_isosurface(7,3,2,'-',100,0.40,'7_3_2_neg.obj')
	write_isosurface(7,3,3,'+',100,0.40,'7_3_3_pos.obj')
	write_isosurface(7,3,3,'-',100,0.40,'7_3_3_neg.obj')
	write_isosurface(7,4,0,None,100,0.50,'7_4_0.obj')
	write_isosurface(7,4,1,'+',100,0.60,'7_4_1_pos.obj')
	write_isosurface(7,4,1,'-',100,0.60,'7_4_1_neg.obj')
	write_isosurface(7,4,2,'+',100,0.60,'7_4_2_pos.obj')
	write_isosurface(7,4,2,'-',100,0.60,'7_4_2_neg.obj')
	write_isosurface(7,4,3,'+',100,0.60,'7_4_3_pos.obj')
	write_isosurface(7,4,3,'-',100,0.60,'7_4_3_neg.obj')
	write_isosurface(7,4,4,'+',100,0.60,'7_4_4_pos.obj')
	write_isosurface(7,4,4,'-',100,0.60,'7_4_4_neg.obj')
	write_isosurface(7,5,0,None,100,0.80,'7_5_0.obj')
	write_isosurface(7,5,1,'+',100,0.80,'7_5_1_pos.obj')
	write_isosurface(7,5,1,'-',100,0.80,'7_5_1_neg.obj')
	write_isosurface(7,5,2,'+',100,0.80,'7_5_2_pos.obj')
	write_isosurface(7,5,2,'-',100,0.80,'7_5_2_neg.obj')
	write_isosurface(7,5,3,'+',100,0.80,'7_5_3_pos.obj')
	write_isosurface(7,5,3,'-',100,0.80,'7_5_3_neg.obj')
	write_isosurface(7,5,4,'+',100,0.80,'7_5_4_pos.obj')
	write_isosurface(7,5,4,'-',100,0.80,'7_5_4_neg.obj')
	write_isosurface(7,5,5,'+',100,0.80,'7_5_5_pos.obj')
	write_isosurface(7,5,5,'-',100,0.80,'7_5_5_neg.obj')
	write_isosurface(7,6,0,None,100,0.90,'7_6_0.obj')
	write_isosurface(7,6,1,'+',100,0.90,'7_6_1_pos.obj')
	write_isosurface(7,6,1,'-',100,0.90,'7_6_1_neg.obj')
	write_isosurface(7,6,2,'+',100,0.90,'7_6_2_pos.obj')
	write_isosurface(7,6,2,'-',100,0.90,'7_6_2_neg.obj')
	write_isosurface(7,6,3,'+',100,0.90,'7_6_3_pos.obj')
	write_isosurface(7,6,3,'-',100,0.90,'7_6_3_neg.obj')
	write_isosurface(7,6,4,'+',100,0.90,'7_6_4_pos.obj')
	write_isosurface(7,6,4,'-',100,0.90,'7_6_4_neg.obj')
	write_isosurface(7,6,5,'+',100,0.90,'7_6_5_pos.obj')
	write_isosurface(7,6,5,'-',100,0.90,'7_6_5_neg.obj')
	write_isosurface(7,6,6,'+',100,0.90,'7_6_6_pos.obj')
	write_isosurface(7,6,6,'-',100,0.90,'7_6_6_neg.obj')
	
